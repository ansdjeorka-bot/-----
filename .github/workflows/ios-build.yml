name: iOS Build

# ìˆ˜ë™ íŠ¸ë¦¬ê±° ë˜ëŠ” push ì‹œ ì‹¤í–‰
on:
  workflow_dispatch:  # GitHubì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥
  push:
    branches: [ main, master ]

jobs:
  build-ios:
    runs-on: macos-latest  # macOSì—ì„œë§Œ iOS ë¹Œë“œ ê°€ëŠ¥
    
    steps:
    - name: Checkout ì½”ë“œ
      uses: actions/checkout@v4
      
    - name: Node.js ì„¤ì •
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: ì˜ì¡´ì„± ì„¤ì¹˜
      run: npm install
      
    - name: ì›¹ ë¹Œë“œ
      run: npm run build
      
    - name: Capacitor iOS í”Œë«í¼ ì¶”ê°€/ë™ê¸°í™”
      run: |
        npx cap add ios || true  # ì´ë¯¸ ìˆìœ¼ë©´ ì˜¤ë¥˜ ë¬´ì‹œ
        npx cap sync ios
        
    - name: iOS í”„ë¡œì íŠ¸ ì •ë³´ í™•ì¸
      run: |
        ls -la ios/
        ls -la ios/App/
        
    # ğŸš¨ ì—¬ê¸°ì„œë¶€í„°ëŠ” Apple Developer ê³„ì •ê³¼ ì¸ì¦ì„œê°€ í•„ìš”í•©ë‹ˆë‹¤!
    # ì•„ë˜ ë‹¨ê³„ë“¤ì€ Apple Developer ê³„ì • ì„¤ì • í›„ì— í™œì„±í™”í•˜ì„¸ìš”.
    
    # - name: Apple Developer ì¸ì¦ì„œ ì„¤ì¹˜
    #   run: |
    #     # Apple Developer ê³„ì •ì—ì„œ ë‹¤ìš´ë¡œë“œí•œ ì¸ì¦ì„œ ì„¤ì¹˜
    #     # ì—¬ê¸°ì— ì¸ì¦ì„œ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ ì˜ˆì •
    #     
    # - name: iOS ë¹Œë“œ (Archive)
    #   run: |
    #     cd ios/App
    #     xcodebuild -workspace App.xcworkspace \
    #                -scheme App \
    #                -configuration Release \
    #                -archivePath App.xcarchive \
    #                archive
    #                
    # - name: IPA ë‚´ë³´ë‚´ê¸°
    #   run: |
    #     cd ios/App
    #     xcodebuild -exportArchive \
    #                -archivePath App.xcarchive \
    #                -exportOptionsPlist ../../ExportOptions.plist \
    #                -exportPath ./
    #                
    # - name: IPA íŒŒì¼ ì—…ë¡œë“œ
    #   uses: actions/upload-artifact@v4
    #   with:
    #     name: iOS-App
    #     path: ios/App/*.ipa